{% extends 'layout/base.html' %}

{% block bodytag %}onload="initialize()" onunload="GUnload()"{% endblock %}

{% block content %}

    {% form form %}
        {% for f in form %}
            {% field f %}
        {% endfor %}
    {% endform %}
    
    <script src="http://maps.google.com/maps?file=api&amp;v=2.x&amp;key=ABQIAAAAzr2EBOXUKnm_jVnk0OJI7xSosDVG8KKPE1-m51RBrvYughuyMxQ-i1QfUnH94QxWIa6N4U6MouMmBA" type="text/javascript"></script> 
    <script type="text/javascript"> 

        var map = null;
        var geocoder = null;

        function initialize() {
          if (GBrowserIsCompatible()) {
            map = new GMap2(document.getElementById("map_canvas"));
            map.setCenter(new GLatLng(37.4419, -122.1419), 13);
            geocoder = new GClientGeocoder();
          }
        }

        function showAddress(address) {
          if (geocoder) {
            geocoder.getLatLng(
              address,
              function(point) {
                if (!point) {
                  alert(address + " not found");
                } else {
                    alert(point);
                  document.getElementById('id_latitude') = point[0];
                  document.getElementById('id_longitude') = point[1];
                  map.setCenter(point, 13);
                  var marker = new GMarker(point);
                  map.addOverlay(marker);
                  marker.openInfoWindowHtml(address);
                }
              }
            );
          }
        }
        </script>
        <input value="Check address" onclick="return showAddress(document.getElementById('id_location').value)" type="button" />
        <div id="map_canvas" style="width: 500px; height: 300px"></div> 


{% endblock %}